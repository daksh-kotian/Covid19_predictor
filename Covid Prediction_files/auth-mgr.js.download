/*! For license information please see auth-mgr.js.LICENSE.txt */
(()=>{var e={206:function(e){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),o=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var o=e.getVersionPrecision(t),i=e.getVersionPrecision(r),a=Math.max(o,i),s=0,c=e.map([t,r],(function(t){var r=a-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(s=a-Math.min(o,i)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var o=e[r];if(t(o,r))return o}},e.assign=function(e){for(var t,r,n=e,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var s=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=i.length;t<r;t+=1)s();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=o,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,o=(n=r(91))&&n.__esModule?n:{default:n},i=r(18);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){}var t,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new o.default(e,t)},e.parse=function(e){return new o.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],null&&a(t.prototype,null),r&&a(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=c(r(92)),o=c(r(93)),i=c(r(94)),a=c(r(95)),s=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,o={},i=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(o[t]=a,i+=1):"object"==typeof a&&(r[t]=a,n+=1)})),n>0){var a=Object.keys(r),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(r[c]);if(void 0!==u)return u}var l=s.default.find(a,(function(e){return t.isPlatform(e)}));if(l){var h=this.satisfies(r[l]);if(void 0!==h)return h}}if(i>0){var d=Object.keys(o),p=s.default.find(d,(function(e){return t.isBrowser(e,!0)}));if(void 0!==p)return this.compareVersion(o[p])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),o=s.default.getBrowserTypeByAlias(n);return t&&o&&(n=o.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,o=this.getBrowserVersion();if("string"==typeof o)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(s.default.compareVersions(o,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,o=(n=r(17))&&n.__esModule?n:{default:n},i=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=o.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(t,e),version:o.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,o=(n=r(17))&&n.__esModule?n:{default:n},i=r(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=o.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},r=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=o.default.getMacOSVersionName(t),n={name:i.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=o.default.getAndroidVersionName(t),n={name:i.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:i.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||o.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,o=(n=r(17))&&n.__esModule?n:{default:n},i=r(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=o.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=o.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,o=(n=r(17))&&n.__esModule?n:{default:n},i=r(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},r=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},r=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},r=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},r=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=a,e.exports=t.default}})}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};function t(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function i(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function a(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var s,c,u,l,h,d={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},p=[d.OPENID_SCOPE,d.PROFILE_SCOPE,d.OFFLINE_ACCESS_SCOPE],f=a(p,[d.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox"}(s||(s={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"}(c||(c={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(u||(u={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox"}(l||(l={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(h||(h={}));var g,m={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(g||(g={}));var y,v,E,C,S,w,T,A={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(y||(y={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(v||(v={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(E||(E={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(C||(C={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(S||(S={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(w||(w={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(T||(T={}));var _,I="appmetadata",b="1",R="authority-metadata";!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(_||(_={}));var O,P={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.POP="pop",e.BEARER="Bearer"}(O||(O={}));var N,k,M,U,L,F="throttling";!function(e){e.username="username",e.password="password"}(N||(N={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(k||(k={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(M||(M={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(U||(U={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(L||(L={}));var H,q="unexpected_error",D="Unexpected error in authentication.",x=function(e){function r(t,n,o){var i=this,a=n?t+": "+n:t;return i=e.call(this,a)||this,Object.setPrototypeOf(i,r.prototype),i.errorCode=t||d.EMPTY_STRING,i.errorMessage=n||"",i.subError=o||"",i.name="AuthError",i}return t(r,e),r.createUnexpectedError=function(e){return new r(q,D+": "+e)},r}(Error),K="client_info_decoding_error",B="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",G="client_info_empty_error",j="The client info was empty. Please review the trace to determine the root cause.",z="token_parsing_error",W="Token cannot be parsed. Please review stack trace to determine root cause.",Y="null_or_empty_token",V="The token is null or empty. Please review the trace to determine the root cause.",Q="endpoints_resolution_error",J="Error: could not resolve endpoints. Please check network and try again.",X="network_error",Z="Network request failed. Please check network trace to determine root cause.",ee="openid_config_error",te="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",re="hash_not_deserialized",ne="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",oe="invalid_state",ie="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",ae="state_mismatch",se="State mismatch error. Please check your network. Continued requests may cause cache overflow.",ce="state_not_found",ue="State not found",le="nonce_mismatch",he="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",de="nonce_not_found",pe="nonce not found",fe="no_tokens_found",ge="No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken().",me="multiple_matching_tokens",ye="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",ve="multiple_matching_accounts",Ee="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",Ce="multiple_matching_appMetadata",Se="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",we="request_cannot_be_made",Te="Token request cannot be made without authorization code or refresh token.",Ae="cannot_append_empty_scope",_e="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",Ie="cannot_remove_empty_scope",be="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",Re="cannot_append_scopeset",Oe="Cannot append ScopeSet due to error.",Pe="empty_input_scopeset",Ne="Empty input ScopeSet cannot be processed.",ke="device_code_polling_cancelled",Me="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",Ue="device_code_expired",Le="Device code is expired.",Fe="device_code_unknown_error",He="Device code stopped polling for unknown reasons.",qe="no_account_in_silent_request",De="Please pass an account object, silent flow is not supported without account information",xe="invalid_cache_record",Ke="Cache record object was null or undefined.",Be="invalid_cache_environment",Ge="Invalid environment when attempting to create cache entry",je="no_account_found",ze="No account found in cache for given key.",We="no cache plugin set on CacheManager",Ye="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",Ve="no_crypto_object",Qe="No crypto object detected. This is required for the following operation: ",Je="invalid_cache_type",Xe="Invalid cache type",Ze="unexpected_account_type",$e="Unexpected account type.",et="unexpected_credential_type",tt="Unexpected credential type.",rt="invalid_assertion",nt="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",ot="invalid_client_credential",it="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",at="token_refresh_required",st="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",ct="user_timeout_reached",ut="User defined timeout for device code polling reached",lt="token_claims_cnf_required_for_signedjwt",ht="Cannot generate a POP jwt if the token_claims are not populated",dt="authorization_code_missing_from_server_response",pt="Server response does not contain an authorization code to proceed",ft=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,r.prototype),o}return t(r,e),r.createClientInfoDecodingError=function(e){return new r(K,B+" Failed with error: "+e)},r.createClientInfoEmptyError=function(){return new r(G,""+j)},r.createTokenParsingError=function(e){return new r(z,W+" Failed with error: "+e)},r.createTokenNullOrEmptyError=function(e){return new r(Y,V+" Raw Token Value: "+e)},r.createEndpointDiscoveryIncompleteError=function(e){return new r(Q,J+" Detail: "+e)},r.createNetworkError=function(e,t){return new r(X,Z+" | Fetch client threw: "+t+" | Attempted to reach: "+e.split("?")[0])},r.createUnableToGetOpenidConfigError=function(e){return new r(ee,te+" Attempted to retrieve endpoints from: "+e)},r.createHashNotDeserializedError=function(e){return new r(re,ne+" Given Object: "+e)},r.createInvalidStateError=function(e,t){return new r(oe,ie+" Invalid State: "+e+", Root Err: "+t)},r.createStateMismatchError=function(){return new r(ae,se)},r.createStateNotFoundError=function(e){return new r(ce,ue+":  "+e)},r.createNonceMismatchError=function(){return new r(le,he)},r.createNonceNotFoundError=function(e){return new r(de,pe+":  "+e)},r.createNoTokensFoundError=function(){return new r(fe,ge)},r.createMultipleMatchingTokensInCacheError=function(){return new r(me,ye+".")},r.createMultipleMatchingAccountsInCacheError=function(){return new r(ve,Ee)},r.createMultipleMatchingAppMetadataInCacheError=function(){return new r(Ce,Se)},r.createTokenRequestCannotBeMadeError=function(){return new r(we,Te)},r.createAppendEmptyScopeToSetError=function(e){return new r(Ae,_e+" Given Scope: "+e)},r.createRemoveEmptyScopeFromSetError=function(e){return new r(Ie,be+" Given Scope: "+e)},r.createAppendScopeSetError=function(e){return new r(Re,Oe+" Detail Error: "+e)},r.createEmptyInputScopeSetError=function(){return new r(Pe,""+Ne)},r.createDeviceCodeCancelledError=function(){return new r(ke,""+Me)},r.createDeviceCodeExpiredError=function(){return new r(Ue,""+Le)},r.createDeviceCodeUnknownError=function(){return new r(Fe,""+He)},r.createNoAccountInSilentRequestError=function(){return new r(qe,""+De)},r.createNullOrUndefinedCacheRecord=function(){return new r(xe,Ke)},r.createInvalidCacheEnvironmentError=function(){return new r(Be,Ge)},r.createNoAccountFoundError=function(){return new r(je,ze)},r.createCachePluginError=function(){return new r(We,""+Ye)},r.createNoCryptoObjectError=function(e){return new r(Ve,""+Qe+e)},r.createInvalidCacheTypeError=function(){return new r(Je,""+Xe)},r.createUnexpectedAccountTypeError=function(){return new r(Ze,""+$e)},r.createUnexpectedCredentialTypeError=function(){return new r(et,""+tt)},r.createInvalidAssertionError=function(){return new r(rt,""+nt)},r.createInvalidCredentialError=function(){return new r(ot,""+it)},r.createRefreshRequiredError=function(){return new r(at,st)},r.createUserTimeoutReachedError=function(){return new r(ct,ut)},r.createTokenClaimsRequiredError=function(){return new r(lt,ht)},r.createNoAuthCodeInServerResponseError=function(){return new r(dt,pt)},r}(x),gt=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw ft.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw ft.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(H||(H={}));var mt=function(){function e(e,t,r){this.level=H.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=e.logLevel||H.Info,this.correlationId=e.correlationId||"",this.packageName=t||d.EMPTY_STRING,this.packageVersion=r||d.EMPTY_STRING}return e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(gt.isEmpty(t.correlationId)?gt.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+H[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:H.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:H.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:H.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:H.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:H.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:H.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:H.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:H.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:H.Trace,containsPii:!1,correlationId:t||""})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:H.Trace,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),yt=function(e,t){return(yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function vt(e,t){function r(){this.constructor=e}yt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Et=function(){return(Et=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Ct(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function St(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function wt(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function Tt(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(wt(arguments[t]));return e}var At,_t,It,bt,Rt,Ot,Pt="interaction_in_progress";!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(At||(At={})),function(e){e.GET="GET",e.POST="POST"}(_t||(_t={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential"}(It||(It={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(bt||(bt={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(Rt||(Rt={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Ot||(Ot={}));var Nt,kt={scopes:p},Mt="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(Nt||(Nt={}));var Ut,Lt=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),Ft=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Lt.decimalToHex(e[0])+Lt.decimalToHex(e[1])+Lt.decimalToHex(e[2])+Lt.decimalToHex(e[3])+"-"+Lt.decimalToHex(e[4])+Lt.decimalToHex(e[5])+"-"+Lt.decimalToHex(e[6])+Lt.decimalToHex(e[7])+"-"+Lt.decimalToHex(e[8])+Lt.decimalToHex(e[9])+"-"+Lt.decimalToHex(e[10])+Lt.decimalToHex(e[11])+Lt.decimalToHex(e[12])+Lt.decimalToHex(e[13])+Lt.decimalToHex(e[14])+Lt.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Ht=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e}(),qt=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Ht.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Dt=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Ht.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,l=0;l<n;l++)if(s=3&l,c|=this.b64ToUint6(r.charCodeAt(l))<<18-6*s,3===s||n-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),xt="pkce_not_created",Kt="The PKCE code challenge and verifier could not be generated.",Bt="crypto_nonexistent",Gt="The crypto object or function is not available.",jt="http_method_not_implemented",zt="The HTTP method given has not been implemented in this library.",Wt="empty_navigate_uri",Yt="Navigation URI is empty. Please check stack trace for more info.",Vt="hash_empty_error",Qt="Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash.",Jt="no_state_in_hash",Xt="Hash does not contain state. Please verify that the request originated from msal.",Zt="hash_does_not_contain_known_properties",$t="Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.",er="unable_to_parse_state",tr="Unable to parse state. Please verify that the request originated from msal.",rr="state_interaction_type_mismatch",nr="Hash contains state but the interaction type does not match the caller.",or="interaction_in_progress",ir="Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors.",ar="popup_window_error",sr="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",cr="empty_window_error",ur="window.open returned null or undefined window object.",lr="user_cancelled",hr="User cancelled the flow.",dr="monitor_window_timeout",pr="Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",fr="monitor_window_timeout",gr="Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",mr="redirect_in_iframe",yr="Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",vr="block_iframe_reload",Er="Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors",Cr="block_nested_popups",Sr="Request was blocked inside a popup because MSAL detected it was running in a popup.",wr="iframe_closed_prematurely",Tr="The iframe being monitored was closed prematurely.",Ar="silent_sso_error",_r="Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid.",Ir="no_account_error",br="No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",Rr="silent_prompt_value_error",Or="The value given for the prompt value is not valid for silent requests - must be set to 'none'.",Pr="no_token_request_cache_error",Nr="No token request in found in cache.",kr="unable_to_parse_token_request_cache_error",Mr="The cached token request could not be parsed.",Ur="no_cached_authority_error",Lr="No cached authority found.",Fr="auth_request_not_set_error",Hr="Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",qr="invalid_cache_type",Dr="Invalid cache type",xr="non_browser_environment",Kr="Login and token requests are not supported in non-browser environments.",Br="database_not_open",Gr="Database is not open!",jr="no_network_connectivity",zr="No network connectivity. Check your internet connection.",Wr="post_request_failed",Yr="Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",Vr="get_request_failed",Qr="Network request failed. Please check the network trace to determine root cause.",Jr="failed_to_parse_response",Xr="Failed to parse network response. Check network trace.",Zr=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return vt(t,e),t.createPkceNotGeneratedError=function(e){return new t(xt,Kt+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Bt,Gt+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(jt,zt+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Wt,Yt)},t.createEmptyHashError=function(e){return new t(Vt,Qt+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(Jt,Xt)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(Zt,$t)},t.createUnableToParseStateError=function(){return new t(er,tr)},t.createStateInteractionTypeMismatchError=function(){return new t(rr,nr)},t.createInteractionInProgressError=function(){return new t(or,ir)},t.createPopupWindowError=function(e){var r=sr;return r=gt.isEmpty(e)?r:r+" Details: "+e,new t(ar,r)},t.createEmptyWindowCreatedError=function(){return new t(cr,ur)},t.createUserCancelledError=function(){return new t(lr,hr)},t.createMonitorPopupTimeoutError=function(){return new t(dr,pr)},t.createMonitorIframeTimeoutError=function(){return new t(fr,gr)},t.createRedirectInIframeError=function(e){return new t(mr,yr+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(vr,Er)},t.createBlockAcquireTokenInPopupsError=function(){return new t(Cr,Sr)},t.createIframeClosedPrematurelyError=function(){return new t(wr,Tr)},t.createSilentSSOInsufficientInfoError=function(){return new t(Ar,_r)},t.createNoAccountError=function(){return new t(Ir,br)},t.createSilentPromptValueError=function(e){return new t(Rr,Or+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(kr,Mr)},t.createNoTokenRequestCacheError=function(){return new t(Pr,Nr)},t.createAuthRequestNotSetError=function(){return new t(Fr,Hr)},t.createNoCachedAuthorityError=function(){return new t(Ur,Lr)},t.createInvalidCacheTypeError=function(){return new t(qr,""+Dr)},t.createNonBrowserEnvironmentError=function(){return new t(xr,Kr)},t.createDatabaseNotOpenError=function(){return new t(Br,Gr)},t.createNoNetworkConnectivityError=function(){return new t(jr,zr)},t.createPostRequestFailedError=function(e,r){return new t(Wr,Yr+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(Vr,Qr+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(Jr,Xr+" | Attempted to reach: "+e.split("?")[0])},t}(x),$r=function(){function e(e){this.base64Encode=new qt,this.cryptoObj=e}return e.prototype.generateCodes=function(){return Ct(this,void 0,void 0,(function(){var e,t;return St(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw Zr.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return Ct(this,void 0,void 0,(function(){var t,r;return St(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),Zr.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),en="SHA-256",tn=new Uint8Array([1,0,1]),rn=function(){function e(){if(!this.hasCryptoAPI())throw Zr.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:en,modulusLength:2048,publicExponent:tn}}return e.prototype.sha256Digest=function(e){return Ct(this,void 0,void 0,(function(){var t;return St(this,(function(r){return t=Ht.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(en,t):this.getSubtleCryptoDigest(en,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw Zr.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return Ct(this,void 0,void 0,(function(){return St(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return Ct(this,void 0,void 0,(function(){return St(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(Mt,e)]}))}))},e.prototype.importJwk=function(t,r,n){return Ct(this,void 0,void 0,(function(){var o,i;return St(this,(function(a){return o=e.getJwkString(t),i=Ht.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,r,n):window.crypto.subtle.importKey(Mt,t,this._keygenAlgorithmOptions,r,n)]}))}))},e.prototype.sign=function(e,t){return Ct(this,void 0,void 0,(function(){return St(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return Ct(this,void 0,void 0,(function(){return St(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return Ct(this,void 0,void 0,(function(){return St(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return Ct(this,void 0,void 0,(function(){var r=this;return St(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return Ct(this,void 0,void 0,(function(){return St(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(Mt,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Ht.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n=this;return St(this,(function(o){return[2,new Promise((function(o,i){var a=window.msCrypto.subtle.importKey(Mt,e,n._keygenAlgorithmOptions,t,r);a.addEventListener("complete",(function(e){o(e.target.result)})),a.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return Ct(this,void 0,void 0,(function(){var r=this;return St(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),nn=function(){function e(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}return e.prototype.open=function(){return Ct(this,void 0,void 0,(function(){var e=this;return St(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(e){return r(e)}))}))]}))}))},e.prototype.get=function(e){return Ct(this,void 0,void 0,(function(){var t=this;return St(this,(function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise((function(r,n){if(!t.db)return n(Zr.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.put=function(e,t){return Ct(this,void 0,void 0,(function(){var r=this;return St(this,(function(n){switch(n.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:n.sent(),n.label=2;case 2:return[2,new Promise((function(n,o){if(!r.db)return o(Zr.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){return o(e)}))}))]}}))}))},e}(),on=function(){function e(){this.browserCrypto=new rn,this.b64Encode=new qt,this.b64Decode=new Dt,this.guidGenerator=new Ft(this.browserCrypto),this.pkceGenerator=new $r(this.browserCrypto),this.cache=new nn(e.DB_NAME,e.TABLE_NAME,e.DB_VERSION)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return Ct(this,void 0,void 0,(function(){return St(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){return Ct(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u;return St(this,(function(l){switch(l.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=l.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=l.sent(),o={e:n.e,kty:n.kty,n:n.n},i=rn.getJwkString(o),[4,this.browserCrypto.sha256Digest(i)];case 3:return a=l.sent(),s=this.b64Encode.urlEncodeArr(new Uint8Array(a)),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return c=l.sent(),[4,this.browserCrypto.importJwk(c,!1,["sign"])];case 5:return u=l.sent(),this.cache.put(s,{privateKey:u,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),[2,s]}}))}))},e.prototype.signJwt=function(e,t){return Ct(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l,h;return St(this,(function(d){switch(d.label){case 0:return[4,this.cache.get(t)];case 1:return r=d.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=d.sent(),o=rn.getJwkString(n),i={alg:n.alg,type:Mt},a=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(o)},s=this.b64Encode.urlEncode(JSON.stringify(e)),c=a+"."+s,u=Ht.stringToArrayBuffer(c),[4,this.browserCrypto.sign(r.privateKey,u)];case 3:return l=d.sent(),h=this.b64Encode.urlEncodeArr(new Uint8Array(l)),[2,c+"."+h]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e.DB_VERSION=1,e.DB_NAME="msal.db",e.TABLE_NAME=e.DB_NAME+".keys",e}(),an={createNewGuid:function(){throw x.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw x.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw x.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw x.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw x.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},signJwt:function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw x.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))}},sn="redirect_uri_empty",cn="A redirect URI is required for all calls, and none has been set.",un="post_logout_uri_empty",ln="A post logout redirect has not been set.",hn="claims_request_parsing_error",dn="Could not parse the given claims request object.",pn="authority_uri_insecure",fn="Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",gn="url_parse_error",mn="URL could not be parsed into appropriate segments.",yn="empty_url_error",vn="URL was empty or null.",En="empty_input_scopes_error",Cn="Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",Sn="clientid_input_scopes_error",wn="Client ID can only be provided as a single scope.",Tn="invalid_prompt_value",An="Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",_n="invalid_claims",In="Given claims parameter must be a stringified JSON object.",bn="token_request_empty",Rn="Token request was empty and not found in cache.",On="logout_request_empty",Pn="The logout request was null or undefined.",Nn="invalid_code_challenge_method",kn='code_challenge_method passed is invalid. Valid values are "plain" and "S256".',Mn="pkce_params_missing",Un="Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",Ln="invalid_cloud_discovery_metadata",Fn="Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields",Hn="invalid_authority_metadata",qn="Invalid authorityMetadata provided. Must by a JSON object containing authorization_endpoint, token_endpoint, end_session_endpoint, issuer fields.",Dn="untrusted_authority",xn="The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",Kn=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,r.prototype),o}return t(r,e),r.createRedirectUriEmptyError=function(){return new r(sn,cn)},r.createPostLogoutRedirectUriEmptyError=function(){return new r(un,ln)},r.createClaimsRequestParsingError=function(e){return new r(hn,dn+" Given value: "+e)},r.createInsecureAuthorityUriError=function(e){return new r(pn,fn+" Given URI: "+e)},r.createUrlParseError=function(e){return new r(gn,mn+" Given Error: "+e)},r.createUrlEmptyError=function(){return new r(yn,vn)},r.createEmptyScopesArrayError=function(){return new r(En,""+Cn)},r.createClientIdSingleScopeError=function(e){return new r(Sn,wn+" Given Scopes: "+e)},r.createInvalidPromptError=function(e){return new r(Tn,An+" Given value: "+e)},r.createInvalidClaimsRequestError=function(){return new r(_n,In)},r.createEmptyLogoutRequestError=function(){return new r(On,Pn)},r.createEmptyTokenRequestError=function(){return new r(bn,Rn)},r.createInvalidCodeChallengeMethodError=function(){return new r(Nn,kn)},r.createInvalidCodeChallengeParamsError=function(){return new r(Mn,Un)},r.createInvalidCloudDiscoveryMetadataError=function(){return new r(Ln,Fn)},r.createInvalidAuthorityMetadataError=function(){return new r(Hn,qn)},r.createUntrustedAuthorityError=function(){return new r(Dn,xn)},r}(ft),Bn=function(){function e(t){if(this._urlString=t,gt.isEmpty(this._urlString))throw Kn.createUrlEmptyError();gt.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return gt.endsWith(t,"?")?t=t.slice(0,-1):gt.endsWith(t,"?/")&&(t=t.slice(0,-2)),gt.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw Kn.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw Kn.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Kn.createInsecureAuthorityUriError(this.urlString)},e.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},e.appendQueryString=function(e,t){return gt.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==u.COMMON&&n[0]!==u.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Kn.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!gt.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Kn.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===d.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(gt.isEmpty(t))return{};var r=e.parseHash(t),n=gt.queryStringToObject(gt.isEmpty(r)?t:r);if(!n)throw ft.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(gt.isEmpty(t))return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),Gn=function(e){function r(t,n,o){var i=e.call(this,t,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,r.prototype),i}return t(r,e),r}(x),jn=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return"throttling."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o,w.THROTTLING);throw new Gn((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||d.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[s.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(s.RETRY_AFTER)&&(e.status<200||e.status>=300)},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))},e.removeThrottle=function(e,t,r,n,o){var i={clientId:t,authority:r,scopes:n,homeAccountIdentifier:o},a=this.generateThrottlingStorageKey(i);return e.removeItem(a,w.THROTTLING)},e}(),zn=["interaction_required","consent_required","login_required"],Wn=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Yn=function(e){function r(t,n,o){var i=e.call(this,t,n,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,r.prototype),i}return t(r,e),r.isInteractionRequiredError=function(e,t,r){var n=!!e&&zn.indexOf(e)>-1,o=!!r&&Wn.indexOf(r)>-1,i=!!t&&zn.some((function(e){return t.indexOf(e)>-1}));return n||i||o},r}(Gn);function Vn(e,t){if(gt.isEmpty(e))throw ft.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw ft.createClientInfoDecodingError(e)}}function Qn(e){if(gt.isEmpty(e))throw ft.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(C.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?d.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(Ut||(Ut={}));var Jn,Xn=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(C.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case E.ADFS_ACCOUNT_TYPE:return T.ADFS;case E.MSAV1_ACCOUNT_TYPE:return T.MSA;case E.MSSTS_ACCOUNT_TYPE:return T.MSSTS;case E.GENERIC_ACCOUNT_TYPE:return T.GENERIC;default:throw ft.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(C.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,a,s){var c,u,l,h,d,p,f=new e;f.authorityType=E.MSSTS_ACCOUNT_TYPE,f.clientInfo=t,f.homeAccountId=r;var g=n.getPreferredCache();if(gt.isEmpty(g))throw ft.createInvalidCacheEnvironmentError();return f.environment=g,f.realm=(null===(c=null==o?void 0:o.claims)||void 0===c?void 0:c.tid)||"",f.oboAssertion=i,o&&(f.idTokenClaims=o.claims,f.localAccountId=(null===(u=null==o?void 0:o.claims)||void 0===u?void 0:u.oid)||(null===(l=null==o?void 0:o.claims)||void 0===l?void 0:l.sub)||"",f.username=(null===(h=null==o?void 0:o.claims)||void 0===h?void 0:h.preferred_username)||((null===(d=null==o?void 0:o.claims)||void 0===d?void 0:d.emails)?o.claims.emails[0]:""),f.name=null===(p=null==o?void 0:o.claims)||void 0===p?void 0:p.name),f.cloudGraphHostName=a,f.msGraphHost=s,f},e.createGenericAccount=function(t,r,n,o,i,a){var s,c,u,l,h=new e;h.authorityType=t.authorityType===Ut.Adfs?E.ADFS_ACCOUNT_TYPE:E.GENERIC_ACCOUNT_TYPE,h.homeAccountId=r,h.realm="",h.oboAssertion=o;var d=t.getPreferredCache();if(gt.isEmpty(d))throw ft.createInvalidCacheEnvironmentError();return n&&(h.localAccountId=(null===(s=null==n?void 0:n.claims)||void 0===s?void 0:s.oid)||(null===(c=null==n?void 0:n.claims)||void 0===c?void 0:c.sub)||"",h.username=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.upn)||"",h.name=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.name)||"",h.idTokenClaims=null==n?void 0:n.claims),h.environment=d,h.cloudGraphHostName=i,h.msGraphHost=a,h},e.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:d.EMPTY_STRING;if(t===Ut.Adfs)return a;if(e)try{var s=Vn(e,n);if(!gt.isEmpty(s.uid)&&!gt.isEmpty(s.utid))return""+s.uid+C.CLIENT_INFO_SEPARATOR+s.utid}catch(e){}return r.verbose("No client info in response"),a},e.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&n},e}();function Zn(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("end_session_endpoint")&&e.hasOwnProperty("issuer")}!function(e){e.AAD="AAD",e.OIDC="OIDC"}(Jn||(Jn={}));var $n,eo=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),to=function(){function e(){this.expiresAt=eo.nowSeconds()+86400}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=eo.nowSeconds()+86400},e.prototype.isExpired=function(){return this.expiresAt<=eo.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf(R)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("end_session_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")},e}(),ro=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,a;return i(this,(function(i){switch(i.label){case 0:if(r=e)return[3,8];i.label=1;case 1:return i.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(d.IMDS_VERSION)];case 2:return(n=i.sent()).status===k.httpSuccess&&(r=n.body,t.region_source=M.IMDS),n.status!==k.httpBadRequest?[3,5]:[4,this.getCurrentVersion()];case 3:return(o=i.sent())?[4,this.getRegionFromIMDS(o)]:(t.region_source=M.FAILED_AUTO_DETECTION,[2,null]);case 4:(a=i.sent()).status===k.httpSuccess&&(r=a.body,t.region_source=M.IMDS),i.label=5;case 5:return[3,7];case 6:return i.sent(),t.region_source=M.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=M.ENVIRONMENT_VARIABLE,i.label=9;case 9:return r||(t.region_source=M.FAILED_AUTO_DETECTION),[2,r||null]}}))}))},e.prototype.getRegionFromIMDS=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.networkInterface.sendGetRequestAsync(d.IMDS_ENDPOINT+"?api-version="+t+"&format=text",e.IMDS_OPTIONS,d.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(d.IMDS_ENDPOINT+"?format=json",e.IMDS_OPTIONS)];case 1:return(t=r.sent()).status===k.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),no=function(){function e(e,t,r,n){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscovery=new ro(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0}}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===d.ADFS?Ut.Adfs:Ut.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Bn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw ft.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw ft.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw ft.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw ft.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw ft.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new Bn(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Ut.Adfs||this.protocolMode===Jn.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return o(this,void 0,void 0,(function(){var e,t,r,n;return i(this,(function(o){switch(o.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new to).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=o.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=o.sent(),t!==_.CACHE&&r!==_.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(t){var r;return o(this,void 0,void 0,(function(){var n,o,a;return i(this,(function(i){switch(i.label){case 0:return(n=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(n,!1),[2,_.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,_.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(n=i.sent())?(null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata)]:[3,3]:[3,4];case 2:o=i.sent(),a=this.authorityOptions.azureRegionConfiguration.azureRegion===d.AZURE_REGION_AUTO_DISCOVER_FLAG?o:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===d.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=o?U.AUTO_DETECTION_REQUESTED_SUCCESSFUL:U.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=o?this.authorityOptions.azureRegionConfiguration.azureRegion===o?U.CONFIGURED_MATCHES_DETECTED:U.CONFIGURED_NOT_DETECTED:U.CONFIGURED_NO_AUTO_DETECTION,a&&(this.regionDiscoveryMetadata.region_used=a,n=e.replaceWithRegionalInformation(n,a)),i.label=3;case 3:return t.updateEndpointMetadata(n,!0),[2,_.NETWORK];case 4:throw ft.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new Bn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Kn.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return o(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,Zn((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,_.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,_.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,_.NETWORK];throw Kn.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(e){throw Kn.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return o(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:t=""+d.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return n=i.sent(),0===(o=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body)?n.body.metadata:[]).length?[2,null]:(r=e.getCloudDiscoveryMetadataFromNetworkResponse(o,this.hostnameAndPort),[3,4]);case 3:return i.sent(),[2,null];case 4:return r||(r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return Bn.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw ft.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return d.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var o=new Bn(e);o.validateAsUri();var i=o.getUrlComponents(),a=t+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=t+"."+d.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=Bn.constructAuthorityUriFromObject(n(n({},o.getUrlComponents()),{HostNameAndPort:a})).urlString;return r?s+"?"+r:s},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,"allowestsrnonmsi=true"),t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r),t},e}(),oo=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,a){return o(this,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:o=e.createInstance(t,r,n,a),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.resolveEndpointsAsync()];case 2:return i.sent(),[2,o];case 3:throw s=i.sent(),ft.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n){if(gt.isEmpty(e))throw Kn.createUrlEmptyError();return new no(e,t,r,n)},e}(),io="4.5.1",ao=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},e.prototype.generateType=function(){switch(this.credentialType){case S.ID_TOKEN:return T.ID_TOKEN;case S.ACCESS_TOKEN:return T.ACCESS_TOKEN;case S.REFRESH_TOKEN:return T.REFRESH_TOKEN;default:throw ft.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(S.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(S.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?S.ACCESS_TOKEN_WITH_AUTH_SCHEME:S.ACCESS_TOKEN:-1!==e.indexOf(S.ID_TOKEN.toLowerCase())?S.ID_TOKEN:-1!==e.indexOf(S.REFRESH_TOKEN.toLowerCase())?S.REFRESH_TOKEN:d.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,r,n,o,i,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)].join(C.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(C.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===S.REFRESH_TOKEN&&n||t,r||""].join(C.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),so=function(){function e(e){var t=this,r=e?gt.trimArrayEntries(a(e)):[],n=r?gt.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Kn.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!gt.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)}))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return f.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){gt.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw ft.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(gt.isEmpty(e))throw ft.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;f.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw ft.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw ft.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}(),co=function(){function e(t,r){if(gt.isEmpty(t))throw ft.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=gt.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw ft.createTokenParsingError(e)}},e}(),uo=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new Xn,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idTokenClaims=new co(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){if(!e)throw ft.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},e.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=so.fromString(e.target),o=Object.keys(r.accessTokens).map((function(e){return r.accessTokens[e]}));o&&o.forEach((function(e){so.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)})),this.setAccessTokenCredential(e)},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var a=n.getAccount(o);a&&(e&&!n.matchHomeAccountId(a,e)||t&&!n.matchEnvironment(a,t)||r&&!n.matchRealm(a,r)||(i[o]=a))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i,a,s){var c=this,u=this.getKeys(),l={idTokens:{},accessTokens:{},refreshTokens:{}};return u.forEach((function(u){var h=ao.getCredentialType(u);if(h!==d.NOT_DEFINED){var p=c.getSpecificCredential(u,h);if(p&&(!s||c.matchOboAssertion(p,s))&&(!e||c.matchHomeAccountId(p,e))&&(!t||c.matchEnvironment(p,t))&&(!i||c.matchRealm(p,i))&&(!r||c.matchCredentialType(p,r))&&(!n||c.matchClientId(p,n))&&(!o||c.matchFamilyId(p,o))&&(!a||c.matchTarget(p,a)))switch(h){case S.ID_TOKEN:l.idTokens[u]=p;break;case S.ACCESS_TOKEN:case S.ACCESS_TOKEN_WITH_AUTH_SCHEME:l.accessTokens[u]=p;break;case S.REFRESH_TOKEN:l.refreshTokens[u]=p}}})),l},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach((function(t){e.getAccount(t)&&e.removeAccount(t)})),!0},e.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw ft.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,w.ACCOUNT)},e.prototype.removeAccountContext=function(e){var t=this,r=this.getKeys(),n=e.generateAccountId();return r.forEach((function(e){var r=ao.getCredentialType(e);if(r!==d.NOT_DEFINED){var o=t.getSpecificCredential(e,r);o&&n===o.generateAccountId()&&t.removeCredential(o)}})),!0},e.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,w.CREDENTIAL)},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,w.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n,o){var i=this.readAccountFromCache(e),a=this.readIdTokenFromCache(t,e),s=this.readAccessTokenFromCache(t,e,r,o),c=this.readRefreshTokenFromCache(t,e,!1),u=this.readAppMetadataFromCache(n,t);return i&&a&&(i.idTokenClaims=new co(a.secret,this.cryptoImpl).claims),{account:i,idToken:a,accessToken:s,refreshToken:c,appMetadata:u}},e.prototype.readAccountFromCache=function(e){var t=Xn.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:S.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),i=o.length;if(i<1)return null;if(i>1)throw ft.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.readAccessTokenFromCache=function(e,t,r,n){var o=n===O.POP?S.ACCESS_TOKEN_WITH_AUTH_SCHEME:S.ACCESS_TOKEN,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:o,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},a=this.getCredentialsFilteredBy(i),s=Object.keys(a.accessTokens).map((function(e){return a.accessTokens[e]})),c=s.length;if(c<1)return null;if(c>1)throw ft.createMultipleMatchingTokensInCacheError();return s[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?b:void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:S.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),a=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return a.length<1?null:a[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw ft.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==b)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==S.ACCESS_TOKEN&&e.credentialType!==S.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=so.fromString(e.target),n=so.fromString(t);return n.containsOnlyOIDCScopes()?n.removeScope(d.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),r.containsScopeSet(n)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(I)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(R)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return"authority-metadata-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case S.ID_TOKEN:return this.getIdTokenCredential(e);case S.ACCESS_TOKEN:case S.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case S.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),lo=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.prototype.setAccount=function(){throw x.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},r.prototype.getAccount=function(){throw x.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},r.prototype.setIdTokenCredential=function(){throw x.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},r.prototype.getIdTokenCredential=function(){throw x.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},r.prototype.setAccessTokenCredential=function(){throw x.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},r.prototype.getAccessTokenCredential=function(){throw x.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},r.prototype.setRefreshTokenCredential=function(){throw x.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},r.prototype.getRefreshTokenCredential=function(){throw x.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},r.prototype.setAppMetadata=function(){throw x.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},r.prototype.getAppMetadata=function(){throw x.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},r.prototype.setServerTelemetry=function(){throw x.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},r.prototype.getServerTelemetry=function(){throw x.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},r.prototype.setAuthorityMetadata=function(){throw x.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},r.prototype.getAuthorityMetadata=function(){throw x.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},r.prototype.getAuthorityMetadataKeys=function(){throw x.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},r.prototype.setThrottlingCache=function(){throw x.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},r.prototype.getThrottlingCache=function(){throw x.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},r.prototype.removeItem=function(){throw x.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},r.prototype.containsKey=function(){throw x.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},r.prototype.getKeys=function(){throw x.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},r.prototype.clear=function(){throw x.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},r}(uo),ho={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},po={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:H.Info,correlationId:""},fo={sendGetRequestAsync:function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw x.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw x.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},go={sku:d.SKU,version:io,cpu:"",os:""},mo={clientSecret:"",clientAssertion:void 0},yo=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return o(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:jn.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof x?o:ft.createNetworkError(t,o);case 4:return jn.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}($n||($n={}));var vo,Eo=function(){function e(e){this.config=function(e){var t,r=e.authOptions,o=e.systemOptions,i=e.loggerOptions,a=e.storageInterface,s=e.networkInterface,c=e.cryptoInterface,u=e.clientCredentials,l=e.libraryInfo,h=e.serverTelemetryManager,d=e.persistencePlugin,p=e.serializableCache;return{authOptions:(t=r,n({clientCapabilities:[]},t)),systemOptions:n(n({},ho),o),loggerOptions:n(n({},po),i),storageInterface:a||new lo(r.clientId,an),networkInterface:s||fo,cryptoInterface:c||an,clientCredentials:u||mo,libraryInfo:n(n({},go),l),serverTelemetryManager:h||null,persistencePlugin:d||null,serializableCache:p||null}}(e),this.logger=new mt(this.config.loggerOptions,"@azure/msal-common",io),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new yo(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[s.CONTENT_TYPE]=d.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case $n.HOME_ACCOUNT_ID:try{var r=Qn(e.credential);t[s.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $n.UPN:t[s.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return o(this,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw ft.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),Co=function(){function e(){}return e.validateRedirectUri=function(e){if(gt.isEmpty(e))throw Kn.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in m)t.push(m[r]);if(t.indexOf(e)<0)throw Kn.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw Kn.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(gt.isEmpty(e)||gt.isEmpty(t))throw Kn.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([A.PLAIN,A.S256].indexOf(e)<0)throw Kn.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),So=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(l.RESPONSE_TYPE,encodeURIComponent(d.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(l.RESPONSE_MODE,encodeURIComponent(e||y.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?a(e||[],p):e||[],n=new so(r);this.parameters.set(l.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(l.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){Co.validateRedirectUri(e),this.parameters.set(l.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Co.validateRedirectUri(e),this.parameters.set(l.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(l.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(g.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(g.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(s.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(s.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(g.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Co.validateClaims(r),this.parameters.set(l.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(l.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(l.X_CLIENT_SKU,e.sku),this.parameters.set(l.X_CLIENT_VER,e.version),this.parameters.set(l.X_CLIENT_OS,e.os),this.parameters.set(l.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){Co.validatePrompt(e),this.parameters.set(""+l.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){gt.isEmpty(e)||this.parameters.set(l.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(l.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Co.validateCodeChallengeParams(e,t),!e||!t)throw Kn.createInvalidCodeChallengeParamsError();this.parameters.set(l.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(l.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(l.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(l.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(l.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(l.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(l.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(l.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(l.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(l.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(l.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(l.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;Co.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw Kn.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(h.ACCESS_TOKEN)||(r[h.ACCESS_TOKEN]={}),r[h.ACCESS_TOKEN][h.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(N.username,e)},e.prototype.addPassword=function(e){this.parameters.set(N.password,e)},e.prototype.addPopToken=function(e){gt.isEmpty(e)||(this.parameters.set(l.TOKEN_TYPE,O.POP),this.parameters.set(l.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(l.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(l.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(l.X_MS_LIB_CAPABILITY,"retry-after, h429")},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),wo=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.createIdTokenEntity=function(e,t,n,o,i,a){var s=new r;return s.credentialType=S.ID_TOKEN,s.homeAccountId=e,s.environment=t,s.clientId=o,s.secret=n,s.realm=i,s.oboAssertion=a,s},r.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===S.ID_TOKEN},r}(ao),To=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.createAccessTokenEntity=function(e,t,n,o,i,a,s,c,u,l,h,d){var p,f=new r;f.homeAccountId=e,f.credentialType=S.ACCESS_TOKEN,f.secret=n;var g=eo.nowSeconds();if(f.cachedAt=g.toString(),f.expiresOn=s.toString(),f.extendedExpiresOn=c.toString(),l&&(f.refreshOn=l.toString()),f.environment=t,f.clientId=o,f.realm=i,f.target=a,f.oboAssertion=d,f.tokenType=gt.isEmpty(h)?O.BEARER:h,f.tokenType===O.POP){f.credentialType=S.ACCESS_TOKEN_WITH_AUTH_SCHEME;var m=co.extractTokenClaims(n,u);if(!(null===(p=null==m?void 0:m.cnf)||void 0===p?void 0:p.kid))throw ft.createTokenClaimsRequiredError();f.keyId=m.cnf.kid}return f},r.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===S.ACCESS_TOKEN||e.credentialType===S.ACCESS_TOKEN_WITH_AUTH_SCHEME)},r}(ao),Ao=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.createRefreshTokenEntity=function(e,t,n,o,i,a){var s=new r;return s.clientId=o,s.credentialType=S.REFRESH_TOKEN,s.environment=t,s.homeAccountId=e,s.secret=n,s.oboAssertion=a,i&&(s.familyId=i),s},r.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===S.REFRESH_TOKEN},r}(ao),_o=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},Io=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return gt.isEmpty(r)?o:""+o+d.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw ft.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw ft.createNoCryptoObjectError("parseRequestState");if(gt.isEmpty(t))throw ft.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(d.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(d.RESOURCE_DELIM):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:gt.isEmpty(o)?"":o,libraryState:a}}catch(e){throw ft.createInvalidStateError(t,e)}},e}();!function(e){e.SW="sw",e.UHW="uhw"}(vo||(vo={}));var bo,Ro=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return o(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return t=n.sent(),r={kid:t,xms_ksl:vo.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(r))]}}))}))},e.prototype.signPopToken=function(e,t){var r;return o(this,void 0,void 0,(function(){var n,o,a,s,c,u;return i(this,(function(i){switch(i.label){case 0:if(n=co.extractTokenClaims(e,this.cryptoUtils),o=t.resourceRequestMethod,a=t.resourceRequestUri,s=t.shrClaims,c=a?new Bn(a):void 0,u=null==c?void 0:c.getUrlComponents(),!(null===(r=null==n?void 0:n.cnf)||void 0===r?void 0:r.kid))throw ft.createTokenClaimsRequiredError();return[4,this.cryptoUtils.signJwt({at:e,ts:eo.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==u?void 0:u.HostNameAndPort,nonce:this.cryptoUtils.createNewGuid(),p:null==u?void 0:u.AbsolutePath,q:(null==u?void 0:u.QueryString)?[[],u.QueryString]:void 0,client_claims:s||void 0},n.cnf.kid)];case 1:return[2,i.sent()]}}))}))},e}(),Oo=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[I,e,t].join(C.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(I)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},e}(),Po=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),No=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?ft.createStateNotFoundError("Cached State"):ft.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw ft.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Yn.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Yn(e.error||d.EMPTY_STRING,e.error_description,e.suberror);throw new Gn(e.error||d.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Vn(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Yn.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Yn(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Gn(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,a,s,c,u){return o(this,void 0,void 0,(function(){var o,l,h,p,f;return i(this,(function(i){switch(i.label){case 0:if(t.id_token&&(o=new co(t.id_token||d.EMPTY_STRING,this.cryptoObj),s&&!gt.isEmpty(s.nonce)&&o.claims.nonce!==s.nonce))throw ft.createNonceMismatchError();this.homeAccountIdentifier=Xn.generateHomeAccountId(t.client_info||d.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,o),s&&s.state&&(l=Io.parseRequestState(this.cryptoObj,s.state)),h=this.generateCacheRecord(t,r,n,o,a.scopes,c,s),i.label=1;case 1:return i.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new Po(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(p)]):[3,3];case 2:i.sent(),i.label=3;case 3:return u&&h.account&&(f=h.account.generateAccountKey(),!this.cacheStorage.getAccount(f))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,h,!1,a,o,l)]):(this.cacheStorage.saveCacheRecord(h),[3,7]);case 4:return this.persistencePlugin&&this.serializableCache&&p?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(p)]):[3,6];case 5:i.sent(),i.label=6;case 6:return[7];case 7:return[2,e.generateAuthenticationResult(this.cryptoObj,r,h,!1,a,o,l)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,u=t.getPreferredCache();if(gt.isEmpty(u))throw ft.createInvalidCacheEnvironmentError();!gt.isEmpty(e.id_token)&&n&&(s=wo.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||d.EMPTY_STRING,this.clientId,n.claims.tid||d.EMPTY_STRING,i),c=this.generateAccountEntity(e,n,t,i,a));var l=null;if(!gt.isEmpty(e.access_token)){var h=e.scope?so.fromString(e.scope):new so(o||[]),p=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,f=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,g=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,m=r+p,y=m+f,v=g&&g>0?r+g:void 0;l=To.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||d.EMPTY_STRING,this.clientId,n?n.claims.tid||d.EMPTY_STRING:t.tenant,h.printScopes(),m,y,this.cryptoObj,v,e.token_type,i)}var E=null;gt.isEmpty(e.refresh_token)||(E=Ao.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||d.EMPTY_STRING,this.clientId,e.foci,i));var C=null;return gt.isEmpty(e.foci)||(C=Oo.createAppMetadataEntity(this.clientId,u,e.foci)),new _o(c,s,l,E,C)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,a=o?o.cloud_graph_host_name:"",s=o?o.msgraph_host:"";if(i===Ut.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Xn.createGenericAccount(r,this.homeAccountIdentifier,t,n,a,s);if(gt.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw ft.createClientInfoEmptyError();return e.client_info?Xn.createAccount(e.client_info,this.homeAccountIdentifier,r,t,n,a,s):Xn.createGenericAccount(r,this.homeAccountIdentifier,t,n,a,s)},e.generateAuthenticationResult=function(e,t,r,n,a,s,c){var u,l,h;return o(this,void 0,void 0,(function(){var o,p,f,g,m,y,v;return i(this,(function(i){switch(i.label){case 0:return o="",p=[],f=null,m=d.EMPTY_STRING,r.accessToken?r.accessToken.tokenType!==O.POP?[3,2]:[4,new Ro(e).signPopToken(r.accessToken.secret,a)]:[3,4];case 1:return o=i.sent(),[3,3];case 2:o=r.accessToken.secret,i.label=3;case 3:p=so.fromString(r.accessToken.target).asArray(),f=new Date(1e3*Number(r.accessToken.expiresOn)),g=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),i.label=4;case 4:return r.appMetadata&&(m=r.appMetadata.familyId===b?b:d.EMPTY_STRING),y=(null==s?void 0:s.claims.oid)||(null==s?void 0:s.claims.sub)||d.EMPTY_STRING,v=(null==s?void 0:s.claims.tid)||d.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:y,tenantId:v,scopes:p,account:r.account?r.account.getAccountInfo():null,idToken:s?s.rawToken:d.EMPTY_STRING,idTokenClaims:s?s.claims:{},accessToken:o,fromCache:n,expiresOn:f,extExpiresOn:g,familyId:m,tokenType:(null===(u=r.accessToken)||void 0===u?void 0:u.tokenType)||d.EMPTY_STRING,state:c?c.userRequestState:d.EMPTY_STRING,cloudGraphHostName:(null===(l=r.account)||void 0===l?void 0:l.cloudGraphHostName)||d.EMPTY_STRING,msGraphHost:(null===(h=r.account)||void 0===h?void 0:h.msGraphHost)||d.EMPTY_STRING}]}}))}))},e}(),ko=function(e){function r(t){return e.call(this,t)||this}return t(r,e),r.prototype.getAuthCodeUrl=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){return t=this.createAuthCodeUrlQueryString(e),[2,Bn.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},r.prototype.acquireToken=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||gt.isEmpty(e.code))throw ft.createTokenRequestCannotBeMadeError();return r=eo.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new No(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),[4,o.handleServerTokenResponse(n.body,this.authority,r,e,t)];case 2:return[2,i.sent()]}}))}))},r.prototype.handleFragmentResponse=function(e,t){var r=new No(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),o=new Bn(e),i=Bn.getDeserializedHash(o.getHash());if(r.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),!i.code)throw ft.createNoAuthCodeInServerResponseError();return n(n({},i),{code:i.code})},r.prototype.getLogoutUri=function(e){if(!e)throw Kn.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(Xn.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return Bn.appendQueryString(this.authority.endSessionEndpoint,t)},r.prototype.executeTokenRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,a,s,c,u;return i(this,(function(i){switch(i.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},[4,this.createTokenRequestBody(t)];case 1:if(n=i.sent(),o=this.createTokenQueryParameters(t),a=void 0,t.clientInfo)try{s=Vn(t.clientInfo,this.cryptoUtils),a={credential:""+s.uid+C.CLIENT_INFO_SEPARATOR+s.utid,type:$n.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return c=this.createTokenRequestHeaders(a||t.ccsCredential),u=gt.isEmpty(o)?e.tokenEndpoint:e.tokenEndpoint+"?"+o,[2,this.executePostToTokenEndpoint(u,n,c,r)]}}))}))},r.prototype.createTokenQueryParameters=function(e){var t=new So;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},r.prototype.createTokenRequestBody=function(e){return o(this,void 0,void 0,(function(){var t,r,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:return(t=new So).addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(v.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==O.POP?[3,2]:[4,new Ro(this.cryptoUtils).generateCnf(e)];case 1:n=i.sent(),t.addPopToken(n),i.label=2;case 2:if(o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!gt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),a=void 0,e.clientInfo)try{s=Vn(e.clientInfo,this.cryptoUtils),a={credential:""+s.uid+C.CLIENT_INFO_SEPARATOR+s.utid,type:$n.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else a=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case $n.HOME_ACCOUNT_ID:try{s=Qn(a.credential),t.addCcsOid(s)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $n.UPN:t.addCcsUpn(a.credential)}return[2,t.createQueryString()]}}))}))},r.prototype.createAuthCodeUrlQueryString=function(e){var t=new So;t.addClientId(this.config.authOptions.clientId);var r=a(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==m.SELECT_ACCOUNT)if(e.sid&&e.prompt===m.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var o=this.extractAccountSid(e.account);if(o&&e.prompt===m.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{var i=Qn(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{i=Qn(e.account.homeAccountId),t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!gt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},r.prototype.createLogoutUrlQueryString=function(e){var t=new So;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},r.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},r}(Eo),Mo=function(e){function r(t){return e.call(this,t)||this}return t(r,e),r.prototype.acquireToken=function(e){return o(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(o){switch(o.label){case 0:return t=eo.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new No(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},r.prototype.acquireTokenByRefreshToken=function(e){return o(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){if(!e)throw Kn.createEmptyTokenRequestError();if(!e.account)throw ft.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(n){if(t=n instanceof ft&&n.errorCode===fe,r=n instanceof Gn&&"invalid_grant"===n.errorCode&&"client_mismatch"===n.subError,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw n}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},r.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return o(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw ft.createNoTokensFoundError();return o=n(n({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||O.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:$n.HOME_ACCOUNT_ID}}),[2,this.acquireToken(o)]}))}))},r.prototype.executeTokenRequest=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=i.sent(),n=this.createTokenQueryParameters(e),o=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes},s=Bn.appendQueryString(t.tokenEndpoint,n),[2,this.executePostToTokenEndpoint(s,r,o,a)]}}))}))},r.prototype.createTokenQueryParameters=function(e){var t=new So;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},r.prototype.createTokenRequestBody=function(e){return o(this,void 0,void 0,(function(){var t,r,n,o,a,s,c;return i(this,(function(i){switch(i.label){case 0:return(t=new So).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(v.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),e.authenticationScheme!==O.POP?[3,2]:(o=new Ro(this.cryptoUtils),s=(a=t).addPopToken,[4,o.generateCnf(e)]);case 1:s.apply(a,[i.sent()]),i.label=2;case 2:if((!gt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case $n.HOME_ACCOUNT_ID:try{c=Qn(e.ccsCredential.credential),t.addCcsOid(c)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case $n.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}}))}))},r}(Eo),Uo=function(e){function r(t){return e.call(this,t)||this}return t(r,e),r.prototype.acquireToken=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof ft&&t.errorCode===at)return[2,new Mo(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},r.prototype.acquireCachedToken=function(e){var t,r,n,a;return o(this,void 0,void 0,(function(){var o,s,c,u;return i(this,(function(i){switch(i.label){case 0:if(!e)throw Kn.createEmptyTokenRequestError();if(!e.account)throw ft.createNoAccountInSilentRequestError();if(o=new so(e.scopes||[]),s=e.authority||this.authority.getPreferredCache(),c=e.authenticationScheme||O.BEARER,u=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,o,s,c),e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(L.FORCE_REFRESH),ft.createRefreshRequiredError();if(!u.accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(L.NO_CACHED_ACCESS_TOKEN),ft.createRefreshRequiredError();if(eo.wasClockTurnedBack(u.accessToken.cachedAt)||eo.isTokenExpired(u.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(L.CACHED_ACCESS_TOKEN_EXPIRED),ft.createRefreshRequiredError();if(u.accessToken.refreshOn&&eo.isTokenExpired(u.accessToken.refreshOn,0))throw null===(a=this.serverTelemetryManager)||void 0===a||a.setCacheOutcome(L.REFRESH_CACHED_ACCESS_TOKEN),ft.createRefreshRequiredError();if(!gt.isEmptyObj(e.claims))throw ft.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(u,e)];case 1:return[2,i.sent()]}}))}))},r.prototype.generateResultFromCacheRecord=function(e,t){return o(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return e.idToken&&(r=new co(e.idToken.secret,this.config.cryptoInterface)),[4,No.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,n.sent()]}}))}))},r}(Eo),Lo=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(P.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),Fo=function(){function e(e,t){this.cacheOutcome=L.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||d.EMPTY_STRING,this.wrapperVer=e.wrapperVer||d.EMPTY_STRING,this.telemetryCacheKey=P.CACHE_KEY+C.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+P.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(P.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(P.VALUE_SEPARATOR);return[P.SCHEMA_VERSION,r,t].join(P.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(P.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(P.VALUE_SEPARATOR),i=t.errors.length,a=[i,r<i?P.OVERFLOW_TRUE:P.OVERFLOW_FALSE].join(P.VALUE_SEPARATOR);return[P.SCHEMA_VERSION,t.cacheHits,n,o,a].join(P.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=P.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),gt.isEmpty(e.subError)?gt.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(P.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new Lo;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new Lo;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||d.EMPTY_STRING,a=e.failedRequests[2*t+1]||d.EMPTY_STRING,s=e.errors[t]||d.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<P.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||""),e.push(this.regionSource||""),e.push(this.regionOutcome||""),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),Ho=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(F));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),qo="redirect_uri_empty",Do="A redirect URI is required for all calls, and none has been set.",xo="post_logout_uri_empty",Ko="A post logout redirect has not been set.",Bo="storage_not_supported",Go="Given storage configuration option was not supported.",jo="no_redirect_callbacks",zo="No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",Wo="stubbed_public_client_application_called",Yo="Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",Vo="in_mem_redirect_unavailable",Qo="Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true.",Jo=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return vt(t,e),t.createRedirectUriEmptyError=function(){return new t(qo,Do)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(xo,Ko)},t.createStorageNotSupportedError=function(e){return new t(Bo,Go+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(jo,zo)},t.createStubPcaInstanceCalledError=function(){return new t(Wo,Yo)},t.createInMemoryRedirectUnavailableError=function(){return new t(Vo,Qo)},t}(x),Xo=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==At.LocalStorage&&e!==At.SessionStorage)throw Jo.createStorageNotSupportedError(e);if(!window[e])throw Jo.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),Zo=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),$o=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(gt.isEmpty(t))return null;try{return Io.parseRequestState(e,t).libraryState.meta}catch(e){throw ft.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Bn(e);return Bn.getDeserializedHash(t.getHash())},e}(),ei=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new Zo,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return vt(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case At.LocalStorage:case At.SessionStorage:try{return new Xo(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=At.MemoryStorage,new Zo},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case At.LocalStorage:case At.SessionStorage:try{return new Xo(At.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case At.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=d.CACHE_PREFIX+"."+c.ID_TOKEN,r=d.CACHE_PREFIX+"."+c.CLIENT_INFO,n=d.CACHE_PREFIX+"."+c.ERROR,o=d.CACHE_PREFIX+"."+c.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[c.ID_TOKEN,c.CLIENT_INFO,c.ERROR,c.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&Xn.isAccountEntity(r)?uo.toObject(new Xn,r):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&wo.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),uo.toObject(new wo,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&To.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),uo.toObject(new To,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ao.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),uo.toObject(new Ao,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Oo.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),uo.toObject(new Oo,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Lo.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),uo.toObject(new Lo,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&to.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),uo.toObject(new to,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(c.ACTIVE_ACCOUNT),t=this.browserStorage.getItem(e);return t&&this.getAccountInfoByFilter({localAccountId:t})[0]||null},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(c.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t))},t.prototype.getAccountInfoByFilter=function(e){return this.getAllAccounts().filter((function(t){return!(e.username&&e.username.toLowerCase()!==t.username.toLowerCase()||e.homeAccountId&&e.homeAccountId!==t.homeAccountId||e.localAccountId&&e.localAccountId!==t.localAccountId||e.tenantId&&e.tenantId!==t.tenantId||e.environment&&e.environment!==t.environment)}))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ho.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),uo.toObject(new Ho,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===At.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return Tt(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){var e=this;this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(d.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear()},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=d.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):gt.startsWith(e,d.CACHE_PREFIX)||gt.startsWith(e,c.ADAL_ID_TOKEN)?e:d.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=Io.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(It.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=Io.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(It.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=Io.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(It.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){var c={credential:o.homeAccountId,type:$n.HOME_ACCOUNT_ID};this.setTemporaryCache(It.CCS_CREDENTIAL,JSON.stringify(c),!0)}else gt.isEmpty(n)||(c={credential:n,type:$n.UPN},this.setTemporaryCache(It.CCS_CREDENTIAL,JSON.stringify(c),!0))},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),gt.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(It.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(It.ORIGIN_URI)),this.removeItem(this.generateCacheKey(It.URL_HASH)),this.removeItem(this.generateCacheKey(It.INTERACTION_STATUS_KEY)),this.removeItem(this.generateCacheKey(It.CCS_CREDENTIAL))},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(It.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=$o.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies()},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(It.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(It.REQUEST_PARAMS,!0);if(!r)throw Zr.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw Zr.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(It.REQUEST_PARAMS)),gt.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Zr.createNoCachedAuthorityError();n.authority=i}return n},t}(uo),ti={sendGetRequestAsync:function(){return Promise.reject(x.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(x.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},ri=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return Ct(this,void 0,void 0,(function(){var r,n,o;return St(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:_t.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?Zr.createGetRequestFailedError(n,e):Zr.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),Zr.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return Ct(this,void 0,void 0,(function(){var r,n,o,i;return St(this,(function(a){switch(a.label){case 0:r=t&&t.body||"",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:_t.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=a.sent(),[3,4];case 3:throw o=a.sent(),window.navigator.onLine?Zr.createPostRequestFailedError(o,e):Zr.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=a.sent(),i.status=n.status,i)];case 6:throw a.sent(),Zr.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),ni=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return Ct(this,void 0,void 0,(function(){return St(this,(function(r){return[2,this.sendRequestAsync(e,_t.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return Ct(this,void 0,void 0,(function(){return St(this,(function(r){return[2,this.sendRequestAsync(e,_t.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&(t===_t.POST?i(Zr.createPostRequestFailedError("Failed with status "+a.status,e)):i(Zr.createGetRequestFailedError("Failed with status "+a.status,e)));try{var r=JSON.parse(a.responseText),s={headers:n.getHeaderDict(a),body:r,status:a.status};o(s)}catch(t){i(Zr.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===_t.POST?i(Zr.createPostRequestFailedError("Failed with status "+a.status,e)):i(Zr.createGetRequestFailedError("Failed with status "+a.status,e)):i(Zr.createNoNetworkConnectivityError())},t===_t.POST&&r&&r.body)a.send(r.body);else{if(t!==_t.GET)throw Zr.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),oi=function(){function e(){}return e.clearHash=function(e){e.location.hash=d.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,d.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal.")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new Bn(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new ri:new ni},e.blockReloadInHiddenIframes=function(){if(Bn.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw Zr.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===Rt.Redirect&&n&&!r)throw Zr.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw Zr.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw Zr.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),ii=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),ai=function(){function e(e,t,r,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.browserRequestLogger=n}return e.prototype.handleCodeResponse=function(e,t,r,n){return Ct(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return St(this,(function(h){switch(h.label){case 0:if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),gt.isEmpty(e))throw Zr.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw ft.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,i),s=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:h.sent(),h.label=2;case 2:return a.nonce=c||void 0,a.state=i,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return l=h.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n,o;return St(this,(function(i){switch(i.label){case 0:return n="https://"+e+"/"+t.tenant+"/",[4,oo.createDiscoveredInstance(n,r,this.browserStorage,t.options)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(It.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),si=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;return a.browserCrypto=i,a}return vt(t,e),t.prototype.initiateAuthRequest=function(e,t){return Ct(this,void 0,void 0,(function(){var r;return St(this,(function(n){switch(n.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),gt.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(It.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(It.INTERACTION_STATUS_KEY,Pt,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:bt.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:return n.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 5:return n.sent(),[2];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Zr.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponse=function(e,t,r,n,o){return Ct(this,void 0,void 0,(function(){var i,a,s,c,u,l,h;return St(this,(function(d){switch(d.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),gt.isEmpty(e))throw Zr.createEmptyHashError(e);if(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(It.INTERACTION_STATUS_KEY)),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw ft.createStateNotFoundError("Cached State");return s=this.authModule.handleFragmentResponse(e,a),c=this.browserStorage.generateNonceKey(a),u=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,n)]:[3,2];case 1:d.sent(),d.label=2;case 2:return s.nonce=u||void 0,s.state=a,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(l=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=l),o&&jn.removeThrottle(this.browserStorage,o,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return h=d.sent(),this.browserStorage.cleanRequestByState(t),[2,h]}}))}))},t}(ai),ci=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,r,n){try{var o=void 0;if(n?(o=n,this.logger.verbosePii("Navigating popup window to: "+t),o.location.assign(t)):void 0===n&&(this.logger.verbosePii("Opening popup window to: "+t),o=e.openSizedPopup(t,r)),!o)throw Zr.createEmptyWindowCreatedError();return o.focus&&o.focus(),this.currentWindow=o,window.addEventListener("beforeunload",this.unloadWindow),o}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(It.INTERACTION_STATUS_KEY)),Zr.createPopupWindowError(e.toString())}},e.openSizedPopup=function(e,t){var r=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=Math.max(0,o/2-241.5+r),s=Math.max(0,i/2-300+n);return window.open(e,t,"width=483, height=600, top="+s+", left="+a+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(Rt.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(It.INTERACTION_STATUS_KEY))},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise((function(r,n){var o=setInterval((function(){if(e.closed)return t.cleanPopup(),clearInterval(o),void n(Zr.createUserCancelledError());var i=d.EMPTY_STRING;try{i=e.location.href}catch(e){}gt.isEmpty(i)||"about:blank"===i||(clearInterval(o),r())}),50)}))},e.generatePopupName=function(e,t){return"msal."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},e.generateLogoutPopupName=function(e,t){return"msal."+e+"."+(t.account&&t.account.homeAccountId)+"."+t.correlationId},e}(),ui=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.popupUtils=new ci(r,o),i}return vt(t,e),t.prototype.initiateAuthRequest=function(e,t){if(gt.isEmpty(e))throw this.browserRequestLogger.error("Navigate url is empty"),Zr.createEmptyNavigationUriError();return this.browserStorage.setTemporaryCache(It.INTERACTION_STATUS_KEY,Pt,!0),this.browserRequestLogger.infoPii("Navigate to: "+e),this.popupUtils.openPopup(e,t.popupName,t.popup)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then((function(){var r=e.location.hash;if(oi.clearHash(e),t.popupUtils.cleanPopup(e),!r)throw Zr.createEmptyHashError(e.location.href);if(Bn.hashContainsKnownProperties(r))return r;throw Zr.createHashDoesNotContainKnownPropertiesError()}))},t}(ai),li=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;return a.navigateFrameWait=i,a}return vt(t,e),t.prototype.initiateAuthRequest=function(e){return Ct(this,void 0,void 0,(function(){var t;return St(this,(function(r){switch(r.label){case 0:if(gt.isEmpty(e))throw this.browserRequestLogger.info("Navigate url is empty"),Zr.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,o){t<6e3&&r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default (6000ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(Zr.createMonitorIframeTimeoutError());var t=d.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:d.EMPTY_STRING}catch(e){}if(!gt.isEmpty(t)){var c=s?s.location.hash:d.EMPTY_STRING;return Bn.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),50)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(ai),hi="@azure/msal-browser",di="2.16.1";!function(e){e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(bo||(bo={}));var pi,fi=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e}(),gi=function(e){function t(t){var r=e.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return vt(t,e),t.prototype.loginRedirect=function(e){return Ct(this,void 0,void 0,(function(){return St(this,(function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||kt)]}))}))},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||kt)},t.prototype.acquireTokenSilent=function(e){return Ct(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return St(this,(function(s){if(this.preflightBrowserEnvironmentCheck(Rt.Silent),this.logger.verbose("acquireTokenSilent called",e.correlationId),!(t=e.account||this.getActiveAccount()))throw Zr.createNoAccountError();return r={clientId:this.config.auth.clientId,authority:e.authority||"",scopes:e.scopes,homeAccountIdentifier:t.homeAccountId},n=JSON.stringify(r),void 0===(o=this.activeSilentTokenRequests.get(n))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",e.correlationId),i=this.acquireTokenSilentAsync(e,t).then((function(e){return a.activeSilentTokenRequests.delete(n),e})).catch((function(e){throw a.activeSilentTokenRequests.delete(n),e})),this.activeSilentTokenRequests.set(n,i),[2,i]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",e.correlationId),[2,o])}))}))},t.prototype.acquireTokenSilentAsync=function(e,t){return Ct(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return St(this,(function(u){switch(u.label){case 0:r=Et(Et(Et({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1}),n=this.logger.clone(hi,di,r.correlationId),this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_START,Rt.Silent,e),u.label=1;case 1:return u.trys.push([1,4,,9]),o=this.initializeServerTelemetryManager(bt.acquireTokenSilent_silentFlow,r.correlationId),[4,this.createSilentFlowClient(o,r.authority,r.correlationId)];case 2:return i=u.sent(),n.verbose("Silent auth client created"),[4,i.acquireCachedToken(r)];case 3:return a=u.sent(),this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_SUCCESS,Rt.Silent,a),[2,a];case 4:u.sent(),u.label=5;case 5:return u.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(r)];case 6:return s=u.sent(),this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_SUCCESS,Rt.Silent,s),[2,s];case 7:throw c=u.sent(),this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_FAILURE,Rt.Silent,null,c),c;case 8:return[3,9];case 9:return[2]}}))}))},t}(function(){function e(e){var t,r,n;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,o=e.system,i={clientId:"",authority:""+d.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Jn.AAD},a={cacheLocation:At.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},s={loggerCallback:function(){},logLevel:H.Info,piiLoggingEnabled:!1},c=Et(Et({},ho),{loggerOptions:s,networkClient:t?oi.getBrowserNetworkClient():ti,navigationClient:new ii,loadFrameTimeout:0,windowHashTimeout:o&&o.loadFrameTimeout||6e4,iframeHashTimeout:o&&o.loadFrameTimeout||6e3,navigateFrameWait:t&&oi.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1});return{auth:Et(Et({},i),r),cache:Et(Et({},a),n),system:Et(Et({},c),o)}}(e,this.isBrowserEnvironment),this.logger=new mt(this.config.system.loggerOptions,hi,di),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.browserCrypto=this.isBrowserEnvironment?new on:an,this.eventHandler=new fi(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new ei(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(t=this.config.auth.clientId,r=this.logger,n={cacheLocation:At.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new ei(t,n,an,r))}return e.prototype.handleRedirectPromise=function(e){return Ct(this,void 0,void 0,(function(){var t,r,n,o=this;return St(this,(function(i){return this.eventHandler.emitEvent(bo.HANDLE_REDIRECT_START,Rt.Redirect),this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||d.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),n=this.handleRedirectResponse(e).then((function(e){return e&&(t.length<o.getAllAccounts().length?(o.eventHandler.emitEvent(bo.LOGIN_SUCCESS,Rt.Redirect,e),o.logger.verbose("handleRedirectResponse returned result, login success")):(o.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_SUCCESS,Rt.Redirect,e),o.logger.verbose("handleRedirectResponse returned result, acquire token success"))),o.eventHandler.emitEvent(bo.HANDLE_REDIRECT_END,Rt.Redirect),e})).catch((function(e){throw t.length>0?o.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_FAILURE,Rt.Redirect,null,e):o.eventHandler.emitEvent(bo.LOGIN_FAILURE,Rt.Redirect,null,e),o.eventHandler.emitEvent(bo.HANDLE_REDIRECT_END,Rt.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.handleRedirectResponse=function(e){return Ct(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u;return St(this,(function(l){switch(l.label){case 0:if(!this.interactionInProgress())return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Rt.Redirect),[2,null];try{r=this.validateAndExtractStateFromHash(t,Rt.Redirect),oi.clearHash(window),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(Rt.Redirect),[2,null]}return n=this.browserStorage.getTemporaryCache(It.ORIGIN_URI,!0)||"",o=Bn.removeHashFromUrl(n),i=Bn.removeHashFromUrl(window.location.href),o===i&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(t,r)]):[3,2];case 1:return a=l.sent(),n.indexOf("#")>-1&&oi.replaceHash(n),[2,a];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(t,r)]);case 3:return oi.isInIframe()?[3,8]:(this.browserStorage.setTemporaryCache(It.URL_HASH,t,!0),s={apiId:bt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},c=!0,n&&"null"!==n?[3,5]:(u=oi.getHomepage(),this.browserStorage.setTemporaryCache(It.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(u,s)]));case 4:return c=l.sent(),[3,7];case 5:return this.logger.verbose("Navigating to loginRequestUrl: "+n),[4,this.navigationClient.navigateInternal(n,s)];case 6:c=l.sent(),l.label=7;case 7:if(!c)return[2,this.handleHash(t,r)];l.label=8;case 8:return[2,null]}}))}))},e.prototype.getRedirectResponseHash=function(e){this.logger.verbose("getRedirectResponseHash called");var t=Bn.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(It.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(It.URL_HASH)),t?(this.logger.verbose("Hash contains known properties, returning response hash"),e):(this.logger.verbose("Hash does not contain known properties, returning cached hash"),r)},e.prototype.validateAndExtractStateFromHash=function(e,t,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var n=Bn.getDeserializedHash(e);if(!n.state)throw Zr.createHashDoesNotContainStateError();var o=$o.extractBrowserRequestState(this.browserCrypto,n.state);if(!o)throw Zr.createUnableToParseStateError();if(o.interactionType!==t)throw Zr.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),n.state},e.prototype.handleHash=function(e,t){return Ct(this,void 0,void 0,(function(){var r,n,o,i,a,s;return St(this,(function(c){switch(c.label){case 0:r=this.browserStorage.getCachedRequest(t,this.browserCrypto),(n=this.logger.clone(hi,di,r.correlationId)).verbose("handleHash called, retrieved cached request"),o=this.initializeServerTelemetryManager(bt.handleRedirectPromise,r.correlationId),c.label=1;case 1:if(c.trys.push([1,4,,5]),!(i=this.browserStorage.getCachedAuthority(t)))throw Zr.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(o,i,r.correlationId)];case 2:return a=c.sent(),n.verbose("Auth code client created"),[4,new si(a,this.browserStorage,r,n,this.browserCrypto).handleCodeResponse(e,t,a.authority,this.networkClient,this.config.auth.clientId)];case 3:return[2,c.sent()];case 4:throw s=c.sent(),o.cacheFailedRequest(s),this.browserStorage.cleanRequestByInteractionType(Rt.Redirect),s;case 5:return[2]}}))}))},e.prototype.acquireTokenRedirect=function(e){return Ct(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u,l;return St(this,(function(h){switch(h.label){case 0:this.preflightBrowserEnvironmentCheck(Rt.Redirect),this.logger.verbose("acquireTokenRedirect called"),(t=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_START,Rt.Redirect,e):this.eventHandler.emitEvent(bo.LOGIN_START,Rt.Redirect,e),r=this.preflightInteractiveRequest(e,Rt.Redirect),n=this.logger.clone(hi,di,r.correlationId),o=this.initializeServerTelemetryManager(bt.acquireTokenRedirect,r.correlationId),h.label=1;case 1:return h.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return i=h.sent(),[4,this.createAuthCodeClient(o,r.authority,r.correlationId)];case 3:return a=h.sent(),n.verbose("Auth code client created"),s=new si(a,this.browserStorage,i,n,this.browserCrypto),[4,a.getAuthCodeUrl(r)];case 4:return c=h.sent(),u=this.getRedirectStartPage(e.redirectStartPage),n.verbosePii("Redirect start page: "+u),[2,s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate})];case 5:throw l=h.sent(),t?this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_FAILURE,Rt.Redirect,null,l):this.eventHandler.emitEvent(bo.LOGIN_FAILURE,Rt.Redirect,null,l),o.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(r.state),l;case 6:return[2]}}))}))},e.prototype.acquireTokenPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck(Rt.Popup),this.logger.verbose("acquireTokenPopup called",e.correlationId),t=this.preflightInteractiveRequest(e,Rt.Popup)}catch(e){return Promise.reject(e)}var r=ci.generatePopupName(this.config.auth.clientId,t);if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token",t.correlationId),this.acquireTokenPopupAsync(t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token",t.correlationId);var n=ci.openSizedPopup("about:blank",r);return this.acquireTokenPopupAsync(t,r,n)},e.prototype.acquireTokenPopupAsync=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,l,h,d,p,f,g;return St(this,(function(m){switch(m.label){case 0:this.logger.verbose("acquireTokenPopupAsync called",e.correlationId),(n=this.getAllAccounts()).length>0?this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_START,Rt.Popup,e):this.eventHandler.emitEvent(bo.LOGIN_START,Rt.Popup,e),o=this.logger.clone(hi,di,e.correlationId),i=this.initializeServerTelemetryManager(bt.acquireTokenPopup,e.correlationId),m.label=1;case 1:return m.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return a=m.sent(),[4,this.createAuthCodeClient(i,e.authority,e.correlationId)];case 3:return s=m.sent(),o.verbose("Auth code client created"),[4,s.getAuthCodeUrl(e)];case 4:return c=m.sent(),u=new ui(s,this.browserStorage,a,o),l={popup:r,popupName:t},h=u.initiateAuthRequest(c,l),this.eventHandler.emitEvent(bo.POPUP_OPENED,Rt.Popup,{popupWindow:h},null),[4,u.monitorPopupForHash(h)];case 5:return d=m.sent(),p=this.validateAndExtractStateFromHash(d,Rt.Popup,e.correlationId),jn.removeThrottle(this.browserStorage,this.config.auth.clientId,a.authority,a.scopes),[4,u.handleCodeResponse(d,p,s.authority,this.networkClient)];case 6:return f=m.sent(),n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(bo.LOGIN_SUCCESS,Rt.Popup,f):this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_SUCCESS,Rt.Popup,f),[2,f];case 7:throw g=m.sent(),n.length>0?this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_FAILURE,Rt.Popup,null,g):this.eventHandler.emitEvent(bo.LOGIN_FAILURE,Rt.Popup,null,g),r&&r.close(),i.cacheFailedRequest(g),this.browserStorage.cleanRequestByState(e.state),g;case 8:return[2]}}))}))},e.prototype.ssoSilent=function(e){return Ct(this,void 0,void 0,(function(){var t,r;return St(this,(function(n){switch(n.label){case 0:this.preflightBrowserEnvironmentCheck(Rt.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(bo.SSO_SILENT_START,Rt.Silent,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(e,bt.ssoSilent)];case 2:return t=n.sent(),this.eventHandler.emitEvent(bo.SSO_SILENT_SUCCESS,Rt.Silent,t),[2,t];case 3:throw r=n.sent(),this.eventHandler.emitEvent(bo.SSO_SILENT_FAILURE,Rt.Silent,null,r),r;case 4:return[2]}}))}))},e.prototype.acquireTokenByIframe=function(e,t){return Ct(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return St(this,(function(u){switch(u.label){case 0:if(this.logger.verbose("acquireTokenByIframe called",e.correlationId),gt.isEmpty(e.loginHint)&&gt.isEmpty(e.sid)&&(!e.account||gt.isEmpty(e.account.username)))throw Zr.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==m.NONE)throw Zr.createSilentPromptValueError(e.prompt);r=this.initializeAuthorizationRequest(Et(Et({},e),{prompt:m.NONE}),Rt.Silent),n=this.logger.clone(hi,di,r.correlationId),o=this.initializeServerTelemetryManager(t,r.correlationId),u.label=1;case 1:return u.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return i=u.sent(),[4,this.createAuthCodeClient(o,r.authority,r.correlationId)];case 3:return a=u.sent(),n.verbose("Auth code client created"),[4,a.getAuthCodeUrl(r)];case 4:return s=u.sent(),[4,this.silentTokenHelper(s,i,a,n)];case 5:return[2,u.sent()];case 6:throw c=u.sent(),o.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(r.state),c;case 7:return[2]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return Ct(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c;return St(this,(function(u){switch(u.label){case 0:this.eventHandler.emitEvent(bo.ACQUIRE_TOKEN_NETWORK_START,Rt.Silent,e),oi.blockReloadInHiddenIframes(),t=Et(Et({},e),this.initializeBaseRequest(e)),r=this.logger.clone(hi,di,t.correlationId),n=this.initializeServerTelemetryManager(bt.acquireTokenSilent_silentFlow,t.correlationId),u.label=1;case 1:return u.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(n,t.authority,t.correlationId)];case 2:return o=u.sent(),r.verbose("Refresh token client created"),[4,o.acquireTokenByRefreshToken(t)];case 3:return[2,u.sent()];case 4:return i=u.sent(),n.cacheFailedRequest(i),a=i instanceof Gn,s=i instanceof Yn,c="invalid_grant"===i.errorCode,a&&c&&!s?(r.verbose("Refresh token expired or invalid, attempting acquire token by iframe"),[4,this.acquireTokenByIframe(e,bt.acquireTokenSilent_authCode)]):[3,6];case 5:return[2,u.sent()];case 6:throw i;case 7:return[2]}}))}))},e.prototype.silentTokenHelper=function(e,t,r,n){return Ct(this,void 0,void 0,(function(){var o,i,a,s;return St(this,(function(c){switch(c.label){case 0:return[4,(o=new li(r,this.browserStorage,t,n,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return i=c.sent(),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return a=c.sent(),s=this.validateAndExtractStateFromHash(a,Rt.Silent,t.correlationId),[2,o.handleCodeResponse(a,s,r.authority,this.networkClient)]}}))}))},e.prototype.logout=function(e){return Ct(this,void 0,void 0,(function(){return St(this,(function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]}))}))},e.prototype.logoutRedirect=function(e){return Ct(this,void 0,void 0,(function(){var t,r,n,o,i,a,s;return St(this,(function(c){switch(c.label){case 0:this.preflightBrowserEnvironmentCheck(Rt.Redirect),this.logger.verbose("logoutRedirect called",null==e?void 0:e.correlationId),t=this.initializeLogoutRequest(e),r=this.logger.clone(hi,di,t.correlationId),n=this.initializeServerTelemetryManager(bt.logout,t.correlationId),c.label=1;case 1:return c.trys.push([1,9,,10]),this.eventHandler.emitEvent(bo.LOGOUT_START,Rt.Redirect,e),[4,this.createAuthCodeClient(n,e&&e.authority,null==t?void 0:t.correlationId)];case 2:return o=c.sent(),r.verbose("Auth code client created"),i=o.getLogoutUri(t),t.account&&!Xn.accountInfoIsEqual(t.account,this.getActiveAccount(),!1)||(r.verbose("Setting active account to null"),this.setActiveAccount(null)),a={apiId:bt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.eventHandler.emitEvent(bo.LOGOUT_SUCCESS,Rt.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,4]:(r.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(i,a)]):[3,6];case 3:return c.sent(),[2];case 4:r.verbose("Logout onRedirectNavigate returned false, stopping navigation"),c.label=5;case 5:return[3,8];case 6:return[4,this.navigationClient.navigateExternal(i,a)];case 7:return c.sent(),[2];case 8:return[3,10];case 9:throw s=c.sent(),n.cacheFailedRequest(s),this.eventHandler.emitEvent(bo.LOGOUT_FAILURE,Rt.Redirect,null,s),s;case 10:return this.eventHandler.emitEvent(bo.LOGOUT_END,Rt.Redirect),[2]}}))}))},e.prototype.logoutPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck(Rt.Popup),this.logger.verbose("logoutPopup called",null==e?void 0:e.correlationId),t=this.initializeLogoutRequest(e)}catch(e){return Promise.reject(e)}var r,n=ci.generateLogoutPopupName(this.config.auth.clientId,t);this.config.system.asyncPopups?this.logger.verbose("asyncPopups set to true",t.correlationId):(this.logger.verbose("asyncPopup set to false, opening popup",t.correlationId),r=ci.openSizedPopup("about:blank",n));var o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.logoutPopupAsync(t,n,o,r,i)},e.prototype.logoutPopupAsync=function(e,t,r,n,o){return Ct(this,void 0,void 0,(function(){var i,a,s,c,u,l,h,d,p,f;return St(this,(function(g){switch(g.label){case 0:this.logger.verbose("logoutPopupAsync called",e.correlationId),this.eventHandler.emitEvent(bo.LOGOUT_START,Rt.Popup,e),i=this.logger.clone(hi,di,e.correlationId),a=this.initializeServerTelemetryManager(bt.logoutPopup,e.correlationId),g.label=1;case 1:return g.trys.push([1,7,,8]),this.browserStorage.setTemporaryCache(It.INTERACTION_STATUS_KEY,Pt,!0),[4,this.createAuthCodeClient(a,r,e.correlationId)];case 2:s=g.sent(),i.verbose("Auth code client created"),c=s.getLogoutUri(e),e.account&&!Xn.accountInfoIsEqual(e.account,this.getActiveAccount(),!1)||(i.verbose("Setting active account to null"),this.setActiveAccount(null)),this.eventHandler.emitEvent(bo.LOGOUT_SUCCESS,Rt.Popup,e),u=new ci(this.browserStorage,this.logger),l=u.openPopup(c,t,n),this.eventHandler.emitEvent(bo.POPUP_OPENED,Rt.Popup,{popupWindow:l},null),g.label=3;case 3:return g.trys.push([3,5,,6]),[4,u.monitorPopupForSameOrigin(l)];case 4:return g.sent(),i.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,6];case 5:return h=g.sent(),i.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+h),[3,6];case 6:return u.cleanPopup(l),o?(d={apiId:bt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=Bn.getAbsoluteUrl(o,oi.getCurrentUri()),i.verbose("Redirecting main window to url specified in the request"),i.verbosePii("Redirecing main window to: "+p),this.navigationClient.navigateInternal(p,d)):i.verbose("No main window navigation requested"),[3,8];case 7:throw f=g.sent(),n&&n.close(),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(It.INTERACTION_STATUS_KEY)),this.eventHandler.emitEvent(bo.LOGOUT_FAILURE,Rt.Popup,null,f),a.cacheFailedRequest(f),f;case 8:return this.eventHandler.emitEvent(bo.LOGOUT_END,Rt.Popup),[2]}}))}))},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!gt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!gt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!gt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||oi.getCurrentUri();return Bn.getAbsoluteUrl(t,oi.getCurrentUri())},e.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return Bn.getAbsoluteUrl(t,oi.getCurrentUri())},e.prototype.getDiscoveredAuthority=function(e,t){return Ct(this,void 0,void 0,(function(){var r;return St(this,(function(n){switch(n.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",t),r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority",t),[4,oo.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,r)]):[3,2];case 1:return[2,n.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority",t),[4,oo.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,r)];case 3:return[2,n.sent()]}}))}))},e.prototype.interactionInProgress=function(){return this.browserStorage.getTemporaryCache(It.INTERACTION_STATUS_KEY,!0)===Pt},e.prototype.createAuthCodeClient=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n;return St(this,(function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new ko(n)]}}))}))},e.prototype.createSilentFlowClient=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n;return St(this,(function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new Uo(n)]}}))}))},e.prototype.createRefreshTokenClient=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n;return St(this,(function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new Mo(n)]}}))}))},e.prototype.getClientConfiguration=function(e,t,r){return Ct(this,void 0,void 0,(function(){var n;return St(this,(function(o){switch(o.label){case 0:return this.logger.verbose("getClientConfiguration called",r),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=o.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:r},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:"msal.js.browser",version:di,cpu:"",os:""}}]}}))}))},e.prototype.preflightInteractiveRequest=function(e,t){if(this.logger.verbose("preflightInteractiveRequest called, validating app environment",null==e?void 0:e.correlationId),oi.blockReloadInHiddenIframes(),this.interactionInProgress())throw Zr.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),oi.blockNonBrowserEnvironment(this.isBrowserEnvironment),oi.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),oi.blockReloadInHiddenIframes(),oi.blockAcquireTokenInPopups(),e===Rt.Redirect&&this.config.cache.cacheLocation===At.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Jo.createInMemoryRedirectUnavailableError()},e.prototype.initializeBaseRequest=function(e){this.logger.verbose("Initializing BaseAuthRequest",e.correlationId);var t=e.authority||this.config.auth.authority,r=Tt(e&&e.scopes||[]),n=e&&e.correlationId||this.browserCrypto.createNewGuid();return e.authenticationScheme?this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request',e.correlationId):(e.authenticationScheme=O.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request',e.correlationId)),Et(Et({},e),{correlationId:n,authority:t,scopes:r})},e.prototype.initializeServerTelemetryManager=function(e,t,r){this.logger.verbose("initializeServerTelemetryManager called",t);var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1,wrapperSKU:this.wrapperSKU,wrapperVer:this.wrapperVer};return new Fo(n,this.browserStorage)},e.prototype.initializeAuthorizationRequest=function(e,t){this.logger.verbose("initializeAuthorizationRequest called",e.correlationId);var r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=Io.setRequestState(this.browserCrypto,e&&e.state||"",n),i=Et(Et({},this.initializeBaseRequest(e)),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:y.FRAGMENT}),a=e.account||this.getActiveAccount();if(a&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+a),i.account=a),gt.isEmpty(i.loginHint)){var s=this.browserStorage.getTemporaryCache(c.ADAL_ID_TOKEN);if(s){var u=new co(s,this.browserCrypto);this.browserStorage.removeItem(c.ADAL_ID_TOKEN),u.claims&&u.claims.upn&&(this.logger.verbose("No SSO params used and ADAL token retrieved, setting ADAL upn as loginHint"),i.loginHint=u.claims.upn)}}return this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||"",i.account||null),i},e.prototype.initializeAuthorizationCodeRequest=function(e){return Ct(this,void 0,void 0,(function(){var t,r;return St(this,(function(n){switch(n.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=Et(Et({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=d.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},e.prototype.initializeLogoutRequest=function(e){if(this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId),this.interactionInProgress())throw Zr.createInteractionInProgressError();var t=Et({correlationId:this.browserCrypto.createNewGuid()},e);return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Bn.getAbsoluteUrl(e.postLogoutRedirectUri,oi.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Bn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,oi.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Bn.getAbsoluteUrl(oi.getCurrentUri(),oi.getCurrentUri())),t},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.wrapperSKU=e,this.wrapperVer=t},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e}()),mi=r(206),yi=r.n(mi),vi=new Uint8Array(16);function Ei(){if(!pi&&!(pi="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pi(vi)}const Ci=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Si=function(e){return"string"==typeof e&&Ci.test(e)};for(var wi=[],Ti=0;Ti<256;++Ti)wi.push((Ti+256).toString(16).substr(1));const Ai=function(e,t,r){var n=(e=e||{}).random||(e.rng||Ei)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(wi[e[t+0]]+wi[e[t+1]]+wi[e[t+2]]+wi[e[t+3]]+"-"+wi[e[t+4]]+wi[e[t+5]]+"-"+wi[e[t+6]]+wi[e[t+7]]+"-"+wi[e[t+8]]+wi[e[t+9]]+"-"+wi[e[t+10]]+wi[e[t+11]]+wi[e[t+12]]+wi[e[t+13]]+wi[e[t+14]]+wi[e[t+15]]).toLowerCase();if(!Si(r))throw TypeError("Stringified UUID is invalid");return r}(n)};var _i;!function(e){e.Core_MSALAuthContext_login="Core_MSALAuthContext_login",e.Core_MSALAuthContext_loginToTenantRedirect="Core_MSALAuthContext_loginToTenantRedirect",e.Core_MSALAuthContext_logout="Core_MSALAuthContext_logout"}(_i||(_i={}));var Ii=function(e){return function(t,r,n){console[e]("Log message: "+t),console[e]("Log event source: "+r),console[e]("Log data: ",n)}},bi={info:Ii("info"),error:Ii("error"),warn:Ii("warn"),customEvent:function(e,t){console.log("Custom event: ",e),console.log("Workspace ID: ",t)}},Ri=function(){return(Ri=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Oi=window.environment,Pi=Oi.adalLoginUri,Ni=Oi.armResourceId,ki=Oi.graphResourceId,Mi=Oi.adalClientId,Ui="organizations",Li=""+Pi+Ui,Fi=window.location.origin+"/Home",Hi=window.location.origin+"/Home/HandleToken",qi=[Ni+"/.default"],Di=function(){function e(e){this.logger=e||bi,this.publicClientApp=this.initPublicClientApp()}return e.prototype.msalLoggerCallback=function(e,t,r){if(!r){var n;switch(e){case H.Error:n=this.logger.error;break;case H.Warning:n=this.logger.warn;break;case H.Info:case H.Verbose:default:n=this.logger.info}n(t,"AuthenticationManager",void 0)}},e.prototype.getAccount=function(){return this.account},e.prototype.initPublicClientApp=function(e){var t=yi().getParser(window.navigator.userAgent),r=t.satisfies({edge:"<79"})||"internet explorer"===t.getBrowserName().toLowerCase();return new gi({auth:{clientId:Mi,authority:Li,redirectUri:Fi,postLogoutRedirectUri:Fi},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:r},system:{tokenRenewalOffsetSeconds:60,iframeHashTimeout:3e4,loggerOptions:{loggerCallback:this.msalLoggerCallback.bind(this),piiLoggingEnabled:!1,logLevel:H.Verbose}}})},e.prototype.loginErrorHandler=function(e){this.logger.error(e.message,"AuthenticationManager",{UIStackTrace:e.stack});var t=Ai();this.logger.customEvent({key:_i.Core_MSALAuthContext_loginToTenantRedirect,type:"Auth",data:{correlationId:t}}),this.publicClientApp.loginRedirect({scopes:qi,authority:Li,correlationId:t})},e.prototype.login=function(){var e,t,r,n=this,o=$.Deferred(),i=window.getRefreshedWorkspaceModel?null===(r=null===(t=null===(e=window.getRefreshedWorkspaceModel())||void 0===e?void 0:e.UserInfo)||void 0===t?void 0:t.UserViewModel)||void 0===r?void 0:r.EmailAddress:void 0;return i?this.publicClientApp.ssoSilent({scopes:qi,loginHint:i,redirectUri:Hi}).then((function(e){n.tokenInfo=e,n.account=e.account||n.getAccount(),o.resolve()})).catch((function(e){n.loginErrorHandler(e)})):this.publicClientApp.handleRedirectPromise().then((function(e){if(n.account=(e?e.account:n.getAccount())||void 0,!n.account){var t=Ai();return n.logger.customEvent({key:_i.Core_MSALAuthContext_login,type:"Auth",data:{correlationId:t}}),n.publicClientApp.loginRedirect({scopes:qi,authority:Li,correlationId:t})}o.resolve()})).catch((function(e){n.loginErrorHandler(e)})),o},e.prototype.getArmToken=function(e){var t=$.Deferred();if(!this.tokenInfo||e&&e!==Ui){var r={authority:e?""+Pi+e:Li,scopes:qi};this.getToken({dfd:t,tokenParameters:r})}else t.resolve(this.tokenInfo.accessToken);return t},e.prototype.getGraphToken=function(e){var t=$.Deferred(),r={authority:e?""+Pi+e:Li,scopes:[ki+"/.default"]};return this.getToken({dfd:t,tokenParameters:r}),t},e.prototype.getToken=function(e){var t=this;this.tokenInfo||this.account?this.acquireTokenSilent(e):this.login().then((function(){t.acquireTokenSilent(e)}))},e.prototype.acquireTokenSilent=function(e){return t=this,r=void 0,o=function(){var t,r,n,o,i,a;return function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(s){switch(s.label){case 0:t=Ai(),r=e.dfd,n=e.tokenParameters,o={scopes:n?n.scopes:qi,authority:n?n.authority:Li,redirectUri:Hi,account:this.account},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.publicClientApp.acquireTokenSilent(o)];case 2:return i=s.sent(),n||(this.account=i.account||void 0),r.resolve(i.accessToken),[3,4];case 3:return(a=s.sent())instanceof Yn?(this.logger.customEvent({key:_i.Core_MSALAuthContext_loginToTenantRedirect,type:"Auth",data:{correlationId:t}}),this.publicClientApp.acquireTokenRedirect(Ri(Ri({},o),{redirectUri:Fi}))):a instanceof Error&&(console.error(a),this.logger.error(a.message,"AuthenticationManager",{UIStackTrace:a.stack})),r.reject(a),[3,4];case 4:return[2]}}))},new((n=void 0)||(n=Promise))((function(e,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,s)}c((o=o.apply(t,r||[])).next())}));var t,r,n,o},e}();window.AuthenticationManager=Di})()})();